{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2025-12-15T21:10:03-07:00",
    "name": "Nginx - PHP-FPM",
    "author": "sinaloensemel@gmail.com",
    "description": "Nginx - PHP-FPM egg",
    "features": null,
    "docker_images": {
        "Nginx - PHP 8.5": "ghcr.io\/sinaloense\/pterodactyl-nginx-phpfpm:8.5",
        "Nginx - PHP 8.4": "ghcr.io\/sinaloense\/pterodactyl-nginx-phpfpm:8.4",
        "Nginx - PHP 8.3": "ghcr.io\/sinaloense\/pterodactyl-nginx-phpfpm:8.3"
    },
    "file_denylist": [],
    "startup": "true",
    "config": {
        "files": "{}",
        "startup": "{\r\n    \"done\": \"start worker process\"\r\n}",
        "logs": "{}",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!\/bin\/bash\r\n# Nginx - PHP-FPM Installation Script\r\n#\r\n\r\n#### Nginx ###\r\napt-get update\r\napt-get install -y nginx\r\n\r\n# Copy Nginx config\r\ncp -afv \/etc\/nginx\/ \/mnt\/server\/\r\nrm -rf \/mnt\/server\/nginx\/sites-enabled\/\r\nmv \/mnt\/server\/nginx\/sites-available\/ \/mnt\/server\/nginx\/sites-enabled\/\r\n\r\n# Create Nginx logs directory\r\nmkdir -p \/mnt\/server\/nginx\/logs\r\n\r\n# Create Nginx tmp directory\r\nmkdir -p \/mnt\/server\/nginx\/tmp\r\n\r\n# Create Nginx ssl directory\r\nmkdir -p \/mnt\/server\/ssl\/certs\r\nmkdir -p \/mnt\/server\/ssl\/private\r\n\r\n# Create html directory\r\nmkdir -p \/mnt\/server\/html\r\n\r\n\r\n\r\n# nginx.conf\r\ncat > \/mnt\/server\/nginx\/nginx.conf << 'EOF'\r\nworker_processes 1;\r\npid \/home\/container\/nginx\/tmp\/nginx.pid;\r\nerror_log \/dev\/stdout info;\r\ninclude \/home\/container\/nginx\/modules-enabled\/*.conf;\r\n\r\nevents {\r\n\tworker_connections 768;\r\n\t# multi_accept on;\r\n}\r\n\r\nhttp {\r\n\t##\r\n\t# Temp Settings\r\n\t##\r\n\tclient_body_temp_path \/home\/container\/nginx\/tmp\/client_body;\r\n    proxy_temp_path       \/home\/container\/nginx\/tmp\/proxy;\r\n    fastcgi_temp_path     \/home\/container\/nginx\/tmp\/fastcgi;\r\n    uwsgi_temp_path       \/home\/container\/nginx\/tmp\/uwsgi;\r\n    scgi_temp_path        \/home\/container\/nginx\/tmp\/scgi;\r\n\r\n    ##\r\n\t# Basic Settings\r\n\t##\r\n\r\n\tsendfile on;\r\n\ttcp_nopush on;\r\n\ttypes_hash_max_size 2048;\r\n\t# server_tokens off;\r\n\r\n\t# server_names_hash_bucket_size 64;\r\n\t# server_name_in_redirect off;\r\n\r\n\tinclude \/home\/container\/nginx\/mime.types;\r\n\tdefault_type application\/octet-stream;\r\n\r\n    ##\r\n\t# SSL Settings\r\n\t##\r\n\r\n\tssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE\r\n\tssl_prefer_server_ciphers on;\r\n\r\n\t##\r\n\t# Logging Settings\r\n\t##\r\n\r\n    access_log \/dev\/stdout;\r\n\r\n    ##\r\n\t# Gzip Settings\r\n\t##\r\n\r\n\tgzip on;\r\n\r\n\t# gzip_vary on;\r\n\t# gzip_proxied any;\r\n\t# gzip_comp_level 6;\r\n\t# gzip_buffers 16 8k;\r\n\t# gzip_http_version 1.1;\r\n\t# gzip_types text\/plain text\/css application\/json application\/javascript text\/xml application\/xml application\/xml+rss text\/javascript;\r\n\r\n    ##\r\n\t# Virtual Host Configs\r\n\t##\r\n\r\n\tinclude \/home\/container\/nginx\/conf.d\/*.conf;\r\n\tinclude \/home\/container\/nginx\/sites-enabled\/*;\r\n}\r\n\r\n\r\n#mail {\r\n#\t# See sample authentication script at:\r\n#\t# http:\/\/wiki.nginx.org\/ImapAuthenticateWithApachePhpScript\r\n#\r\n#\t# auth_http localhost\/auth.php;\r\n#\t# pop3_capabilities \"TOP\" \"USER\";\r\n#\t# imap_capabilities \"IMAP4rev1\" \"UIDPLUS\";\r\n#\r\n#\tserver {\r\n#\t\tlisten     localhost:110;\r\n#\t\tprotocol   pop3;\r\n#\t\tproxy      on;\r\n#\t}\r\n#\r\n#\tserver {\r\n#\t\tlisten     localhost:143;\r\n#\t\tprotocol   imap;\r\n#\t\tproxy      on;\r\n#\t}\r\n#}\r\nEOF\r\n\r\n\r\n\r\n# default.conf\r\ncat > \/mnt\/server\/nginx\/sites-enabled\/default << 'EOF'\r\n##\r\n# You should look at the following URL's in order to grasp a solid understanding\r\n# of Nginx configuration files in order to fully unleash the power of Nginx.\r\n# https:\/\/www.nginx.com\/resources\/wiki\/start\/\r\n# https:\/\/www.nginx.com\/resources\/wiki\/start\/topics\/tutorials\/config_pitfalls\/\r\n# https:\/\/wiki.debian.org\/Nginx\/DirectoryStructure\r\n#\r\n# In most cases, administrators will remove this file from sites-enabled\/ and\r\n# leave it as reference inside of sites-available where it will continue to be\r\n# updated by the nginx packaging team.\r\n#\r\n# This file will automatically load configuration files provided by other\r\n# applications, such as Drupal or Wordpress. These applications will be made\r\n# available underneath a path with that package name, such as \/drupal8.\r\n#\r\n# Please see \/usr\/share\/doc\/nginx-doc\/examples\/ for more detailed examples.\r\n##\r\n\r\n# Default server configuration\r\n#\r\nserver {\r\n\tlisten 80 default_server;\r\n\tlisten [::]:80 default_server;\r\n\r\n\t# SSL configuration\r\n\t#\r\n\t# listen 443 ssl default_server;\r\n\t# listen [::]:443 ssl default_server;\r\n\t#\r\n\t# Note: You should disable gzip for SSL traffic.\r\n\t# See: https:\/\/bugs.debian.org\/773332\r\n\t#\r\n\t# Read up on ssl_ciphers to ensure a secure configuration.\r\n\t# See: https:\/\/bugs.debian.org\/765782\r\n\t#\r\n\t# Self signed certs generated by the ssl-cert package\r\n\t# Don't use them in a production server!\r\n\t#\r\n\t# include snippets\/snakeoil.conf;\r\n\r\n\troot \/home\/container\/html;\r\n\r\n\t# Add index.php to the list if you are using PHP\r\n\tindex index.php index.html index.htm index.nginx-debian.html;\r\n\r\n\tserver_name _;\r\n\r\n\t# Print logs on console\r\n\taccess_log \/dev\/stdout;\r\n    error_log \/dev\/stdout info;\r\n    \r\n\t# Print logs to file\r\n    access_log \/home\/container\/nginx\/logs\/access.log;\r\n    error_log \/home\/container\/nginx\/logs\/error.log;\r\n\r\n\t# Disable gzip\r\n\tgzip off;\r\n\r\n\tlocation \/ {\r\n\t\t# First attempt to serve request as file, then\r\n\t\t# as directory, then fall back to displaying a 404.\r\n\t\ttry_files $uri $uri\/ =404;\r\n\t}\r\n\r\n\t# pass PHP scripts to FastCGI server\r\n\t#\r\n\t#location ~ \\.php$ {\r\n\t#\tinclude snippets\/fastcgi-php.conf;\r\n\t#\r\n\t#\t# With php-fpm (or other unix sockets):\r\n\t#\tfastcgi_pass unix:\/run\/php\/php7.4-fpm.sock;\r\n\t#\t# With php-cgi (or other tcp sockets):\r\n\t#\tfastcgi_pass 127.0.0.1:9000;\r\n\t#}\r\n\r\n\t# deny access to .htaccess files, if Apache's document root\r\n\t# concurs with nginx's one\r\n\t#\r\n\t#location ~ \/\\.ht {\r\n\t#\tdeny all;\r\n\t#}\r\n}\r\n\r\n\r\n# Virtual Host configuration for example.com\r\n#\r\n# You can move that to a different file under sites-available\/ and symlink that\r\n# to sites-enabled\/ to enable it.\r\n#\r\n#server {\r\n#\tlisten 80;\r\n#\tlisten [::]:80;\r\n#\r\n#\tserver_name example.com;\r\n#\r\n#\troot \/var\/www\/example.com;\r\n#\tindex index.html;\r\n#\r\n#\tlocation \/ {\r\n#\t\ttry_files $uri $uri\/ =404;\r\n#\t}\r\n#}\r\nEOF\r\n\r\n\r\n\r\n# Replace default\r\nsed -i \"s#^\\tlisten 80 default_server;#\\tlisten $SERVER_PORT default_server;#\" \/mnt\/server\/nginx\/sites-enabled\/default\r\nsed -i \"s#^\\tlisten \\[::\\]:80 default_server;#\\tlisten [::]:$SERVER_PORT default_server;#\" \/mnt\/server\/nginx\/sites-enabled\/default\r\nif [ -n \"$PHP_VERSION\" ]; then\r\n    sed -i '\/^\\t# pass PHP scripts to FastCGI server$\/c\\\r\n\\tlocation ~ \\.php$ {\\\r\n\\t\\tinclude \/home\/container\/nginx\/fastcgi_params;\\\r\n\\t\\tfastcgi_pass unix:\/home\/container\/fpm\/tmp\/php-fpm.sock;\\\r\n\\t\\tfastcgi_param SCRIPT_FILENAME $document_root\/$fastcgi_script_name;\\\r\n\\t}\\\r\n\\\r\n\\t# pass PHP scripts to FastCGI server' \/mnt\/server\/nginx\/sites-enabled\/default\r\nfi\r\n\r\n\r\n\r\n# cloudflare-realip.conf\r\ncat > \/mnt\/server\/nginx\/conf.d\/cloudflare-realip.conf << 'EOF'\r\nset_real_ip_from 173.245.48.0\/20;\r\nset_real_ip_from 103.21.244.0\/22;\r\nset_real_ip_from 103.22.200.0\/22;\r\nset_real_ip_from 103.31.4.0\/22;\r\nset_real_ip_from 141.101.64.0\/18;\r\nset_real_ip_from 108.162.192.0\/18;\r\nset_real_ip_from 190.93.240.0\/20;\r\nset_real_ip_from 188.114.96.0\/20;\r\nset_real_ip_from 197.234.240.0\/22;\r\nset_real_ip_from 198.41.128.0\/17;\r\nset_real_ip_from 162.158.0.0\/15;\r\nset_real_ip_from 104.16.0.0\/13;\r\nset_real_ip_from 104.24.0.0\/14;\r\nset_real_ip_from 172.64.0.0\/13;\r\nset_real_ip_from 131.0.72.0\/22;\r\n\r\nset_real_ip_from 2400:cb00::\/32;\r\nset_real_ip_from 2606:4700::\/32;\r\nset_real_ip_from 2803:f800::\/32;\r\nset_real_ip_from 2405:b500::\/32;\r\nset_real_ip_from 2405:8100::\/32;\r\nset_real_ip_from 2a06:98c0::\/29;\r\nset_real_ip_from 2c0f:f248::\/32;\r\n\r\nset_real_ip_from 172.18.0.0\/16;\r\n\r\nset_real_ip_from fdba:17c8:6c94::\/64;\r\n\r\nreal_ip_header CF-Connecting-IP;\r\nEOF\r\n\r\n\r\n\r\n# limit-req-zone.conf\r\ncat > \/mnt\/server\/nginx\/conf.d\/limit-req-zone.conf << 'EOF'\r\nlimit_req_zone $binary_remote_addr zone=mylimit:100m rate=50r\/s;\r\nlimit_req zone=mylimit burst=150 nodelay;\r\nlimit_req_status 429;\r\nEOF\r\n\r\n\r\n\r\n# index.html\r\ncat > \/mnt\/server\/html\/index.html << 'EOF'\r\nhello world!\r\nEOF\r\n\r\n\r\n\r\n\r\n\r\n#### PHP-FPM ###\r\nVALID_VERSIONS=(\"8.3\" \"8.4\" \"8.5\")\r\n\r\nif [[ ! \" ${VALID_VERSIONS[@]} \" =~ \" ${PHP_VERSION} \" ]]; then\r\n    echo \"ERROR: PHP_VERSION must be 8.3, 8.4, or 8.5 (detected: ${PHP_VERSION})\"\r\n    exit 1\r\nfi\r\n\r\nif [ -z \"$NGINX_PRESENT\" ]; then\r\n\tapt-get update\r\nfi\r\napt-get install -y wget\r\nwget -O \/etc\/apt\/trusted.gpg.d\/php.gpg https:\/\/packages.sury.org\/php\/apt.gpg\r\necho \"deb https:\/\/packages.sury.org\/php\/ bookworm main\" > \/etc\/apt\/sources.list.d\/php.list\r\napt-get update\r\napt-get install -y php$PHP_VERSION-fpm\r\n\r\n# Copy PHP-FPM config\r\ncp -afv \/etc\/php\/$PHP_VERSION\/fpm\/ \/mnt\/server\/\r\nrm -rf \/mnt\/server\/fpm\/conf.d\/*\r\nrm -f \/mnt\/server\/fpm\/php.ini\r\n\r\n# Create PHP-FPM logs directory\r\nmkdir -p \/mnt\/server\/fpm\/logs\r\n\r\n# Create PHP-FPM tmp directory\r\nmkdir -p \/mnt\/server\/fpm\/tmp\r\n\r\n# Create PHP-FPM upload tmp directory\r\nmkdir -p \/mnt\/server\/fpm\/tmp_upload\r\n\r\n# Create PHP-FPM sessions directory\r\nmkdir -p \/mnt\/server\/fpm\/sessions\r\n\r\n# Create html directory\r\nmkdir -p \/mnt\/server\/html\r\n\r\n\r\n\r\n# Replace php-fpm.conf\r\nsed -i \"s#^pid = \/run\/php\/php$PHP_VERSION-fpm.pid#pid = \/home\/container\/fpm\/tmp\/php-fpm.pid#\" \/mnt\/server\/fpm\/php-fpm.conf\r\nsed -i \"s#^error_log = \/var\/log\/php$PHP_VERSION-fpm.log#error_log = \/home\/container\/fpm\/logs\/php-fpm.log#\" \/mnt\/server\/fpm\/php-fpm.conf\r\nsed -i \"s#^include=\/etc\/php\/$PHP_VERSION\/fpm\/pool.d\/\\*.conf#include = \/home\/container\/fpm\/pool.d\/\\*.conf#\" \/mnt\/server\/fpm\/php-fpm.conf\r\n\r\n\r\n\r\n# Replace www.conf\r\nsed -i \"s#^user = www-data#;user = container#\" \/mnt\/server\/fpm\/pool.d\/www.conf\r\nsed -i \"s#^group = www-data#;group = container#\" \/mnt\/server\/fpm\/pool.d\/www.conf\r\nif [ -n \"$NGINX_PRESENT\" ]; then\r\n    sed -i \"s#^listen = \/run\/php\/php$PHP_VERSION-fpm.sock#listen = \/home\/container\/fpm\/tmp\/php-fpm.sock#\" \/mnt\/server\/fpm\/pool.d\/www.conf\r\nelse\r\n    sed -i \"s#^listen = \/run\/php\/php$PHP_VERSION-fpm.sock#listen = 0.0.0.0:$SERVER_PORT#\" \/mnt\/server\/fpm\/pool.d\/www.conf\r\nfi\r\nsed -i \"s#^listen.owner = www-data#listen.owner = 999#\" \/mnt\/server\/fpm\/pool.d\/www.conf\r\nsed -i \"s#^listen.group = www-data#listen.group = 995#\" \/mnt\/server\/fpm\/pool.d\/www.conf\r\n\r\n\r\n\r\n# 99-custom.ini\r\ncat > \/mnt\/server\/fpm\/conf.d\/99-custom.ini << 'EOF'\r\n; Maximum amount of memory a script may consume\r\n; https:\/\/php.net\/memory-limit\r\nmemory_limit = 128M\r\n\r\n; Maximum size of POST data that PHP will accept.\r\n; Its value may be 0 to disable the limit. It is ignored if POST data reading\r\n; is disabled through enable_post_data_reading.\r\n; http:\/\/php.net\/post-max-size\r\npost_max_size = 105M\r\n\r\n; Maximum allowed size for uploaded files.\r\n; http:\/\/php.net\/upload-max-filesize\r\nupload_max_filesize = 100M\r\n\r\n\r\n\r\n; This directive allows you to disable certain functions.\r\n; It receives a comma-delimited list of function names.\r\n; https:\/\/php.net\/disable-functions\r\ndisable_functions = \"propro,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals\"\r\n\r\n; Log errors to specified file. PHP's default behavior is to leave this value\r\n; empty.\r\n; https:\/\/php.net\/error-log\r\n; Example:\r\nerror_log = \"\/home\/container\/fpm\/logs\/php_errors.log\"\r\n\r\n; Directory where the temporary files should be placed.\r\n; Defaults to the system default (see sys_get_temp_dir)\r\nsys_temp_dir = \"\/home\/container\/fpm\/tmp\"\r\n\r\n; Temporary directory for HTTP uploaded files (will use system default if not\r\n; specified).\r\n; https:\/\/php.net\/upload-tmp-dir\r\nupload_tmp_dir = \"\/home\/container\/fpm\/tmp_upload\"\r\n\r\n; Argument passed to save_handler.  In the case of files, this is the path\r\n; where data files are stored. Note: Windows users have to change this\r\n; variable in order to use PHP's session functions.\r\n;\r\n; The path can be defined as:\r\n;\r\n;     session.save_path = \"N;\/path\"\r\n;\r\n; where N is an integer.  Instead of storing all the session files in\r\n; \/path, what this will do is use subdirectories N-levels deep, and\r\n; store the session data in those directories.  This is useful if\r\n; your OS has problems with many files in one directory, and is\r\n; a more efficient layout for servers that handle many sessions.\r\n;\r\n; NOTE 1: PHP will not create this directory structure automatically.\r\n;         You can use the script in the ext\/session dir for that purpose.\r\n; NOTE 2: See the section on garbage collection below if you choose to\r\n;         use subdirectories for session storage\r\n;\r\n; The file storage module creates files using mode 600 by default.\r\n; You can change that by using\r\n;\r\n;     session.save_path = \"N;MODE;\/path\"\r\n;\r\n; where MODE is the octal representation of the mode. Note that this\r\n; does not overwrite the process's umask.\r\n; https:\/\/php.net\/session.save-path\r\nsession.save_path = \"\/home\/container\/fpm\/sessions\"\r\n\r\n; Sets the directory name where SOAP extension will put cache files.\r\n; https:\/\/php.net\/soap.wsdl-cache-dir\r\nsoap.wsdl_cache_dir = \"\/home\/container\/fpm\/tmp\"\r\n\r\n; Absolute path used to store shared lockfiles (for *nix only).\r\nopcache.lockfile_path = \"\/home\/container\/fpm\/tmp\"\r\nEOF\r\n\r\n# php-info.php\r\ncat > \/mnt\/server\/html\/php-info.php << 'EOF'\r\n<?php\r\nphpinfo();\r\nEOF",
            "container": "debian@sha256:b4aa902587c2e61ce789849cb54c332b0400fe27b1ee33af4669e1f7e7c3e22f",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "name": "PHP_VERSION",
            "description": "Must match the PHP version defined in the egg.",
            "env_variable": "PHP_VERSION",
            "default_value": "8.5",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:8.5,8.4,8.3",
            "field_type": "text"
        },
        {
            "name": "NGINX_PRESENT",
            "description": "Only used in the install script.",
            "env_variable": "NGINX_PRESENT",
            "default_value": "true",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|string|in:true",
            "field_type": "text"
        }
    ]
}